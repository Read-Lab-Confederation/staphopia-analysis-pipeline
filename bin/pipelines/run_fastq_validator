#! /usr/bin/env python
""" Test input file to determine if it is a valid FASTQ file. """
from ruffus import *
from staphopia.tasks import fastq

parser = cmdline.get_argparse(description='Validate FASTQ files')
parser.add_argument("-f", "--fastq", dest="fastq", required=True,
                    help="Compressed FASTQ file (*.tar.gz)",)
options = parser.parse_args()

# Pipeline --------------------------------------------------------------------


@transform(options.fastq, regex(r"(.*)"), r"\1.stats")
def validate(input_file, output_file):
    """ Test validity of FASTQ file. """
    print fastq.validator(options.fastq)

# -----------------------------------------------------------------------------
pipeline_run(exceptions_terminate_immediately=True, verbose=0)
